var b=Object.defineProperty;var C=(t,e,s)=>e in t?b(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var g=(t,e,s)=>(C(t,typeof e!="symbol"?e+"":e,s),s);import{r as a,R,j as h,O,_ as M,F as w,n as P}from"./index-437f41ad.js";var n={},_={get exports(){return n},set exports(t){n=t}},W="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",x=W,N=x;function E(){}function T(){}T.resetWarningCache=E;var F=function(){function t(r,o,i,l,p,u){if(u!==N){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var s={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:T,resetWarningCache:E};return s.PropTypes=s,s};_.exports=F();class L extends a.Component{constructor(e){super(e),this.scrollListener=this.scrollListener.bind(this),this.eventListenerOptions=this.eventListenerOptions.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this)}componentDidMount(){this.pageLoaded=this.props.pageStart,this.options=this.eventListenerOptions(),this.attachScrollListener()}componentDidUpdate(){if(this.props.isReverse&&this.loadMore){const e=this.getParentElement(this.scrollComponent);e.scrollTop=e.scrollHeight-this.beforeScrollHeight+this.beforeScrollTop,this.loadMore=!1}this.attachScrollListener()}componentWillUnmount(){this.detachScrollListener(),this.detachMousewheelListener()}isPassiveSupported(){let e=!1;const s={get passive(){e=!0}};try{document.addEventListener("test",null,s),document.removeEventListener("test",null,s)}catch{}return e}eventListenerOptions(){let e=this.props.useCapture;return this.isPassiveSupported()?e={useCapture:this.props.useCapture,passive:!0}:e={passive:!1},e}setDefaultLoader(e){this.defaultLoader=e}detachMousewheelListener(){let e=window;this.props.useWindow===!1&&(e=this.scrollComponent.parentNode),e.removeEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture)}detachScrollListener(){let e=window;this.props.useWindow===!1&&(e=this.getParentElement(this.scrollComponent)),e.removeEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),e.removeEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture)}getParentElement(e){const s=this.props.getScrollParent&&this.props.getScrollParent();return s??(e&&e.parentNode)}filterProps(e){return e}attachScrollListener(){const e=this.getParentElement(this.scrollComponent);if(!this.props.hasMore||!e)return;let s=window;this.props.useWindow===!1&&(s=e),s.addEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture),s.addEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),s.addEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture),this.props.initialLoad&&this.scrollListener()}mousewheelListener(e){e.deltaY===1&&!this.isPassiveSupported()&&e.preventDefault()}scrollListener(){const e=this.scrollComponent,s=window,r=this.getParentElement(e);let o;if(this.props.useWindow){const i=document.documentElement||document.body.parentNode||document.body,l=s.pageYOffset!==void 0?s.pageYOffset:i.scrollTop;this.props.isReverse?o=l:o=this.calculateOffset(e,l)}else this.props.isReverse?o=r.scrollTop:o=e.scrollHeight-r.scrollTop-r.clientHeight;o<Number(this.props.threshold)&&e&&e.offsetParent!==null&&(this.detachScrollListener(),this.beforeScrollHeight=r.scrollHeight,this.beforeScrollTop=r.scrollTop,typeof this.props.loadMore=="function"&&(this.props.loadMore(this.pageLoaded+=1),this.loadMore=!0))}calculateOffset(e,s){return e?this.calculateTopPosition(e)+(e.offsetHeight-s-window.innerHeight):0}calculateTopPosition(e){return e?e.offsetTop+this.calculateTopPosition(e.offsetParent):0}render(){const e=this.filterProps(this.props),{children:s,element:r,hasMore:o,initialLoad:i,isReverse:l,loader:p,loadMore:u,pageStart:c,ref:f,threshold:m,useCapture:v,useWindow:Y,getScrollParent:q,...S}=e;S.ref=y=>{this.scrollComponent=y,f&&f(y)};const d=[s];return o&&(p?l?d.unshift(p):d.push(p):this.defaultLoader&&(l?d.unshift(this.defaultLoader):d.push(this.defaultLoader))),R.createElement(r,S,d)}}g(L,"propTypes",{children:n.node.isRequired,element:n.node,hasMore:n.bool,initialLoad:n.bool,isReverse:n.bool,loader:n.node,loadMore:n.func.isRequired,pageStart:n.number,ref:n.func,getScrollParent:n.func,threshold:n.number,useCapture:n.bool,useWindow:n.bool}),g(L,"defaultProps",{element:"div",hasMore:!1,initialLoad:!0,pageStart:0,ref:null,threshold:250,useWindow:!0,isReverse:!1,useCapture:!1,loader:null,getScrollParent:null});function H(){return h("div",{className:" p-12 ",children:h(O,{height:80,width:80,color:"#4fa94d",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"oval-loading",secondaryColor:"#4fa94d",strokeWidth:2,strokeWidthSecondary:2})})}function D(t,e,s,r){const o=new RegExp(r,"i");return t.filter(i=>{let l=!0;return e!=null&&i.region!=s[e]&&(l=!1),r!=""&&!o.test(i.name.common)&&(l=!1),l})}const j=(t,e,s,r,o)=>{if(t.length===s.length||t.length>s.length)r(!1);else{const i=t.length+o>=s.length;e(i?t.concat(s.slice(t.length)):t.concat(s.slice(t.length,t.length+o)))}},k=a.lazy(()=>M(()=>import("./index-437f41ad.js").then(t=>t.C),["assets/index-437f41ad.js","assets/index-f5c4cd14.css"]));function I(t){const{infiniteScrollList:e}=t,{favoriteCountries:s}=a.useContext(w);for(var r=[],o=0;o<e.length;o++)s&&s[e[o].name.common]?e[o]={...e[o],isFavorite:!0}:e[o]={...e[o],isFavorite:!1},r.push(h(k,{country:e[o]},P()));return r}function U(t){const{countriesList:e}=t,{searchFilter:s,regionIndex:r,dropDownContent:o}=a.useContext(w),[i,l]=a.useState(e),p=20,[u,c]=a.useState(i.slice(0,p)),[f,m]=a.useState(!0);a.useEffect(()=>{m(!0),l(()=>D(e,r,o,s))},[s,r]),a.useEffect(()=>{i.length>p?c(i.slice(0,p)):c(i)},[i]);function v(){j(u,c,i,m,p)}return h(L,{pageStart:0,loadMore:v,hasMore:f,loader:h(H,{},P()),threshold:500,className:"grid justify-center justify-items-center gap-5 grid-cols-countriesMap mx-auto pb-14",children:h(I,{infiniteScrollList:u})})}const V=a.memo(U);export{V as default};
