var C=Object.defineProperty;var b=(s,e,t)=>e in s?C(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var v=(s,e,t)=>(b(s,typeof e!="symbol"?e+"":e,t),t);import{r as a,R as O,j as f,O as M,_,A as W,a as x,d as N,F as D}from"./index-3c069e17.js";var n={},H={get exports(){return n},set exports(s){n=s}},F="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",U=F,j=U;function P(){}function T(){}T.resetWarningCache=P;var k=function(){function s(o,r,l,i,h,p){if(p!==j){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}s.isRequired=s;function e(){return s}var t={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:e,element:s,elementType:s,instanceOf:e,node:s,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:T,resetWarningCache:P};return t.PropTypes=t,t};H.exports=k();class S extends a.Component{constructor(e){super(e),this.scrollListener=this.scrollListener.bind(this),this.eventListenerOptions=this.eventListenerOptions.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this)}componentDidMount(){this.pageLoaded=this.props.pageStart,this.options=this.eventListenerOptions(),this.attachScrollListener()}componentDidUpdate(){if(this.props.isReverse&&this.loadMore){const e=this.getParentElement(this.scrollComponent);e.scrollTop=e.scrollHeight-this.beforeScrollHeight+this.beforeScrollTop,this.loadMore=!1}this.attachScrollListener()}componentWillUnmount(){this.detachScrollListener(),this.detachMousewheelListener()}isPassiveSupported(){let e=!1;const t={get passive(){e=!0}};try{document.addEventListener("test",null,t),document.removeEventListener("test",null,t)}catch{}return e}eventListenerOptions(){let e=this.props.useCapture;return this.isPassiveSupported()?e={useCapture:this.props.useCapture,passive:!0}:e={passive:!1},e}setDefaultLoader(e){this.defaultLoader=e}detachMousewheelListener(){let e=window;this.props.useWindow===!1&&(e=this.scrollComponent.parentNode),e.removeEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture)}detachScrollListener(){let e=window;this.props.useWindow===!1&&(e=this.getParentElement(this.scrollComponent)),e.removeEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),e.removeEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture)}getParentElement(e){const t=this.props.getScrollParent&&this.props.getScrollParent();return t??(e&&e.parentNode)}filterProps(e){return e}attachScrollListener(){const e=this.getParentElement(this.scrollComponent);if(!this.props.hasMore||!e)return;let t=window;this.props.useWindow===!1&&(t=e),t.addEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture),t.addEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),t.addEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture),this.props.initialLoad&&this.scrollListener()}mousewheelListener(e){e.deltaY===1&&!this.isPassiveSupported()&&e.preventDefault()}scrollListener(){const e=this.scrollComponent,t=window,o=this.getParentElement(e);let r;if(this.props.useWindow){const l=document.documentElement||document.body.parentNode||document.body,i=t.pageYOffset!==void 0?t.pageYOffset:l.scrollTop;this.props.isReverse?r=i:r=this.calculateOffset(e,i)}else this.props.isReverse?r=o.scrollTop:r=e.scrollHeight-o.scrollTop-o.clientHeight;r<Number(this.props.threshold)&&e&&e.offsetParent!==null&&(this.detachScrollListener(),this.beforeScrollHeight=o.scrollHeight,this.beforeScrollTop=o.scrollTop,typeof this.props.loadMore=="function"&&(this.props.loadMore(this.pageLoaded+=1),this.loadMore=!0))}calculateOffset(e,t){return e?this.calculateTopPosition(e)+(e.offsetHeight-t-window.innerHeight):0}calculateTopPosition(e){return e?e.offsetTop+this.calculateTopPosition(e.offsetParent):0}render(){const e=this.filterProps(this.props),{children:t,element:o,hasMore:r,initialLoad:l,isReverse:i,loader:h,loadMore:p,pageStart:u,ref:d,threshold:w,useCapture:L,useWindow:m,getScrollParent:y,...g}=e;g.ref=E=>{this.scrollComponent=E,d&&d(E)};const c=[t];return r&&(h?i?c.unshift(h):c.push(h):this.defaultLoader&&(i?c.unshift(this.defaultLoader):c.push(this.defaultLoader))),O.createElement(o,g,c)}}v(S,"propTypes",{children:n.node.isRequired,element:n.node,hasMore:n.bool,initialLoad:n.bool,isReverse:n.bool,loader:n.node,loadMore:n.func.isRequired,pageStart:n.number,ref:n.func,getScrollParent:n.func,threshold:n.number,useCapture:n.bool,useWindow:n.bool}),v(S,"defaultProps",{element:"div",hasMore:!1,initialLoad:!0,pageStart:0,ref:null,threshold:250,useWindow:!0,isReverse:!1,useCapture:!1,loader:null,getScrollParent:null});function A(){return f("div",{className:" p-12 ",children:f(M,{height:80,width:80,color:"#4fa94d",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"oval-loading",secondaryColor:"#4fa94d",strokeWidth:2,strokeWidthSecondary:2})})}function I(s,e,t,o){const r=new RegExp(o,"i");return s.filter(l=>{let i=!0;return e!=null&&l.region!=t[e]&&(i=!1),o!=""&&!r.test(l.name.common)&&(i=!1),i})}const Y=(s,e,t,o,r)=>{if(s.length===t.length||s.length>t.length)o(!1);else{const l=s.length+r>=t.length;e(l?s.concat(t.slice(s.length)):s.concat(t.slice(s.length,s.length+r)))}};let R=(s=21)=>crypto.getRandomValues(new Uint8Array(s)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");const q=a.lazy(()=>_(()=>import("./CountryElement-de3b2161.js"),["assets/CountryElement-de3b2161.js","assets/index-3c069e17.js","assets/index-d90c4b6e.css"]));function z(s){const{infiniteScrollList:e,favoriteCountries:t}=s;for(var o=[],r=0;r<e.length;r++)t&&t[e[r].name.common]&&(e[r]={...e[r],isFavorite:!0}),o.push(f(q,{country:e[r]},R()));return o}async function V(s,e){const t=W(N,"users",s),o=await x(t);o.exists()?e(o.data()):(console.log("No such document!"),e(null))}function $(s){const{countriesList:e}=s,{searchFilter:t,regionIndex:o,dropDownContent:r,user:l}=a.useContext(D),[i,h]=a.useState(e),p=20,[u,d]=a.useState(i.slice(0,p)),[w,L]=a.useState(!0),m=a.useRef(null),[y,g]=a.useState(null);a.useEffect(()=>{L(!0),h(()=>I(e,o,r,t))},[t,o]),a.useEffect(()=>{i.length>p?d(i.slice(0,p)):d(i)},[i]);function c(){Y(u,d,i,L,p)}return a.useEffect(()=>{l&&(!m.current||m.current.uid!=l.uid)&&(m.current=l,V(l.uid,g))},[l]),f(S,{pageStart:0,loadMore:c,hasMore:w,loader:f(A,{},R()),threshold:500,className:"grid justify-center justify-items-center gap-5 grid-cols-countriesMap mx-auto pb-14",children:f(z,{infiniteScrollList:u,favoriteCountries:y})})}const J=a.memo($);export{J as default};
